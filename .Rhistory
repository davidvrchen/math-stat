# print(0.006730552/sd(centered))
x2 <- seq(min(centered), max(centered), length=length(centered)-1)
x2 <- seq(min(centered), max(centered), length=length(centered)-1)
fun1 <- dst(x2, sigma=sd(centered)*0.9, nu=5)
fun21 <- dst(x2, sigma=0.006730552, nu=9.636221)
fun2 <- dst(x2, mu=params$estimate[1], sigma=sd, nu=df)
fun3 <- dst(x2, sigma=sd(centered), nu=length(centered)-1)
hist(centered, prob=TRUE, breaks=20)
# lines(x2, fun1, col=1,lwd=2)
lines(x2, fun2, col=2,lwd=2)
# lines(x2, fun3, col=3,lwd=2)
qst(0.01, mu=params$estimate[1], sigma=params$estimate[2], nu=params$estimate[3])
quantile(aex_2004$Returns, probs=0.01)
? theme
ggplot(aex) +
geom_line(mapping=aes(x=Date, y=Open, group=1), color = "blue", linetype = "solid", linewidth = .1) +
geom_line(mapping=aes(x=Date, y=Close, group=1), color = "red", linetype = "solid", linewidth = .1) +
scale_x_date(date_breaks = "1 year", date_labels =  "%Y") +
theme(axis.text=substitute(past(bold)),axis.text.x=element_text(angle=60, hjust=1))
ggplot(aex) +
geom_line(mapping=aes(x=Date, y=Open, group=1), color = "blue", linetype = "solid", linewidth = .1) +
geom_line(mapping=aes(x=Date, y=Close, group=1), color = "red", linetype = "solid", linewidth = .1) +
scale_x_date(date_breaks = "1 year", date_labels =  "%Y") +
theme(axis.text=bold,axis.text.x=element_text(angle=60, hjust=1))
ggplot(aex) +
geom_line(mapping=aes(x=Date, y=Open, group=1), color = "blue", linetype = "solid", linewidth = .1) +
geom_line(mapping=aes(x=Date, y=Close, group=1), color = "red", linetype = "solid", linewidth = .1) +
scale_x_date(date_breaks = "1 year", date_labels =  "%Y") +
theme(axis.text="bold",axis.text.x=element_text(angle=60, hjust=1))
ggplot(aex) +
geom_line(mapping=aes(x=Date, y=Open, group=1), color = "blue", linetype = "solid", linewidth = .1) +
geom_line(mapping=aes(x=Date, y=Close, group=1), color = "red", linetype = "solid", linewidth = .1) +
scale_x_date(date_breaks = "1 year", date_labels =  "%Y") +
theme(axis.text.face="bold",axis.text.x=element_text(angle=60, hjust=1))
ggplot(aex) +
geom_line(mapping=aes(x=Date, y=Open, group=1), color = "blue", linetype = "solid", linewidth = .1) +
geom_line(mapping=aes(x=Date, y=Close, group=1), color = "red", linetype = "solid", linewidth = .1) +
scale_x_date(date_breaks = "1 year", date_labels =  "%Y") +
theme(text.face="bold",axis.text.x=element_text(angle=60, hjust=1))
ggplot(aex) +
geom_line(mapping=aes(x=Date, y=Open, group=1), color = "blue", linetype = "solid", linewidth = .1) +
geom_line(mapping=aes(x=Date, y=Close, group=1), color = "red", linetype = "solid", linewidth = .1) +
scale_x_date(date_breaks = "1 year", date_labels =  "%Y") +
theme(axis.text=element_text(face="bold"),axis.text.x=element_text(angle=60, hjust=1))
ggplot(aex) +
geom_line(mapping=aes(x=Date, y=Open, group=1), color = "blue", linetype = "solid", linewidth = .1) +
geom_line(mapping=aes(x=Date, y=Close, group=1), color = "red", linetype = "solid", linewidth = .1) +
scale_x_date(date_breaks = "1 year", date_labels =  "%Y") +
theme_ipsum() +
theme(axis.text=element_text(face="bold"),axis.text.x=element_text(angle=60, hjust=1))
library(hrbrthemes)
install.packages("hrbrthemes")
library(hrbrthemes)
ggplot(aex) +
geom_line(mapping=aes(x=Date, y=Open, group=1), color = "blue", linetype = "solid", linewidth = .1) +
geom_line(mapping=aes(x=Date, y=Close, group=1), color = "red", linetype = "solid", linewidth = .1) +
scale_x_date(date_breaks = "1 year", date_labels =  "%Y") +
theme_ipsum() +
theme(axis.text=element_text(face="bold"),axis.text.x=element_text(angle=60, hjust=1))
ggplot(aex) +
geom_line(mapping=aes(x=Date, y=Open, group=1), color = "blue", linetype = "solid", linewidth = .1) +
geom_line(mapping=aes(x=Date, y=Close, group=1), color = "red", linetype = "solid", linewidth = .1) +
scale_x_date(date_breaks = "1 year", date_labels =  "%Y") +
theme(axis.text.x=element_text(angle=60, hjust=1))
plot(cars)
# Load the data.
library("ggplot2")
aex = read.csv("AEX.csv")
aex$Date = as.Date(aex$Date)
library(hrbrthemes)
ggplot(aex) +
geom_line(mapping=aes(x=Date, y=Open, group=1), color = "blue", linetype = "solid", linewidth = .1) +
geom_line(mapping=aes(x=Date, y=Close, group=1), color = "red", linetype = "solid", linewidth = .1) +
scale_x_date(date_breaks = "1 year", date_labels =  "%Y") +
theme_ipsum() +
theme(axis.text=element_text(face="bold"),axis.title.x=element_text(face="bold"),axis.title.y=element_text(face="bold"),axis.text.x=element_text(angle=60, hjust=1))
aex_1993_1995 = aex[aex$Date>="1993-01-01" & aex$Date<= "1995-01-01",]
aex_1996_1998 = aex[aex$Date>= "1996-01-01" & aex$Date<="1998-01-01",]
print(paste("1993-1995 Opening Prices mean:", mean(aex_1993_1995$Close), ", sample deviation: " , sd(aex_1993_1995$Close), ", observations: ", length(aex_1993_1995$Close), sep=""))
print(paste("1996-1998 Opening Prices mean:", mean(aex_1996_1998$Close), ", sample deviation: " , sd(aex_1996_1998$Close), ", observations: ", length(aex_1993_1995$Close), sep=""))
aex$Returns = (aex$Close - aex$Open) / aex$Open
ggplot(aex) +
geom_point(mapping=aes(x=Date, y=Returns, group=1), color = "blue", size = 0.05)
print(summary(aex$Returns))
print(paste("SD: ", sd(aex$Returns)))
hist(aex$Returns, breaks=100)
aex$Year = format(aex$Date, "%Y")
boxplot(aex$Returns ~ aex$Year)
aex_2004 = aex[aex$Year == 2004, ]
aex_2006 = aex[aex$Year == 2006, ]
auto_corr <- function(ordered, k) {
sample_mean <- mean(ordered)
sample_var <- var(ordered)
count <- length(ordered)
first_demeaned <- ordered[1:(count-k)] - sample_mean
if (k > 0) {
shifted_demeaned <- ordered[-(1:k)] - sample_mean
} else {
shifted_demeaned <- ordered - sample_mean
}
return((1/((count-k)*sample_var)) * sum(first_demeaned*shifted_demeaned))
}
acf_2004 = c()
for (k in 0:(length(aex_2004$Returns)-1)) {
acf_2004 <- append(acf_2004, auto_corr(rev(aex_2004$Returns), k))
}
plot(acf_2004)
builtin_acf_2004 = acf(rev(aex_2004$Returns), lag.max=(length(aex_2004$Returns)-1), plot=FALSE)$acf[]
plot(builtin_acf_2004)
acf_2006 = c()
for (k in 0:(length(aex_2006$Returns)-1)) {
acf_2006 <- append(acf_2006, auto_corr(rev(aex_2006$Returns), k))
}
plot(acf_2006)
builtin_acf_2006 = acf(rev(aex_2006$Returns), lag.max=(length(aex_2006$Returns)-1), plot=FALSE)$acf[]
plot(builtin_acf_2006)
guess <- function(ordered, k) {
sample_mean <- mean(ordered)
sample_var <- var(ordered)
count <- length(ordered)
first_demeaned <- ordered[1:(count-k)] - sample_mean
if (k > 0) {
shifted_demeaned <- ordered[-(1:k)] - sample_mean
} else {
shifted_demeaned <- ordered - sample_mean
}
return((1/((count)*sample_var)) * sum(first_demeaned*shifted_demeaned))
}
gacf_2004 = c()
for (k in 0:(length(aex_2004$Returns)-1)) {
gacf_2004 <- append(gacf_2004, guess(rev(aex_2004$Returns), k))
}
gacf_2006 = c()
for (k in 0:(length(aex_2006$Returns)-1)) {
gacf_2006 <- append(gacf_2006, guess(rev(aex_2006$Returns), k))
}
plot(gacf_2004)
plot(gacf_2006)
library("car")
hist(aex_2004$Returns, breaks=20)
hist(aex_2006$Returns, breaks=20)
qqPlot(aex_2004$Returns)
qqPlot((aex_2006$Returns))
qqPlot(aex$Returns)
plot(density(aex_2004$Returns))
plot(density(aex_2006$Returns))
boxplot(aex_2004$Returns)
boxplot(aex_2006$Returns)
v_mm_est <- function(data) {
second_moment_expected <- mean(data^2)
v_mm <- -2*second_moment_expected/(1-second_moment_expected)
return(v_mm)
}
est <- v_mm_est(aex_2004$Returns - mean(aex_2004$Returns))
est
library(LaplacesDemon)
library(dplyr)
library(MASS)
centered <- aex_2004$Returns - mean(aex_2004$Returns)
params = fitdistr(centered, "t")
df=params$estimate[3]
sd = params$estimate[2]
# print(0.006730552/sd(centered))
x2 <- seq(min(centered), max(centered), length=length(centered)-1)
x2 <- seq(min(centered), max(centered), length=length(centered)-1)
fun1 <- dst(x2, sigma=sd(centered)*0.9, nu=5)
fun21 <- dst(x2, sigma=0.006730552, nu=9.636221)
fun2 <- dst(x2, mu=params$estimate[1], sigma=sd, nu=df)
fun3 <- dst(x2, sigma=sd(centered), nu=length(centered)-1)
hist(centered, prob=TRUE, breaks=20)
# lines(x2, fun1, col=1,lwd=2)
lines(x2, fun2, col=2,lwd=2)
# lines(x2, fun3, col=3,lwd=2)
centered <- aex_2004$Returns - mean(aex_2004$Returns)
params = fitdistr(centered, "t")
df=params$estimate[3]
sd = params$estimate[2]
# print(0.006730552/sd(centered))
x2 <- seq(min(centered), max(centered), length=length(centered)-1)
x2 <- seq(min(centered), max(centered), length=length(centered)-1)
fun1 <- dst(x2, sigma=sd(centered)*0.9, nu=5)
fun21 <- dst(x2, sigma=0.006730552, nu=9.636221)
fun2 <- dst(x2, mu=params$estimate[1], sigma=sd, nu=df)
fun3 <- dst(x2, sigma=sd(centered), nu=length(centered)-1)
hist(centered, prob=TRUE, breaks=20)
# lines(x2, fun1, col=1,lwd=2)
lines(x2, fun2, col=2,lwd=2)
# lines(x2, fun3, col=3,lwd=2)
qst(0.01, mu=params$estimate[1], sigma=params$estimate[2], nu=params$estimate[3])
quantile(aex_2004$Returns, probs=0.01)
centered <- aex_2004$Returns - mean(aex_2004$Returns)
params = fitdistr(centered, "lognormal")
?fitdistr
centered <- aex_2004$Returns - mean(aex_2004$Returns)
params = fitdistr(centered, "t")
df=params$estimate[3]
sd = params$estimate[2]
# print(0.006730552/sd(centered))
x2 <- seq(min(centered), max(centered), length=length(centered)-1)
fun2 <- dst(x2, mu=params$estimate[1], sigma=sd, nu=df)
hist(centered, prob=TRUE, breaks=20)
lines(x2, fun2, col=2,lwd=2)
quantile(aex_2004$Returns, probs=0.01)
quantile(aex_2006$Returns, probs=0.01)
centered_2004 <- aex_2004$Returns - mean(aex_2004$Returns)
params_2004 = fitdistr(centered_2004, "t")
df_2004=params_2004$estimate[3]
sd_2004 = params_2004$estimate[2]
x_2004 <- seq(min(centered_2004), max(centered_2004), length=length(centered_2004)-1)
# fun1 <- dst(x2, sigma=sd(centered)*0.9, nu=5)
# fun21 <- dst(x2, sigma=0.006730552, nu=9.636221)
fun2 <- dst(x_2004, mu=params_2004$estimate[1], sigma=sd_2004, nu=df_2004)
# fun3 <- dst(x2, sigma=sd(centered), nu=length(centered)-1)
hist(centered_2004, prob=TRUE, breaks=20)
# lines(x2, fun1, col=1,lwd=2)
lines(x_2004, fun2, col=2,lwd=2)
# lines(x2, fun3, col=3,lwd=2)
centered_2006 <- aex_2006$Returns - mean(aex_2006$Returns)
params_2006 = fitdistr(centered_2006, "t")
df_2006 =params_2006$estimate[3]
sd_2006 = params_2006$estimate[2]
x_2006 <- seq(min(centered_2006), max(centered_2006), length=length(centered_2006)-1)
fun_2006 <- dst(x_2006, mu=params_2006$estimate[1], sigma=sd_2006, nu=df_2006)
hist(centered_2006, prob=TRUE, breaks=20)
lines(x_2006, fun_2006, col=2,lwd=2)
var_2004 = qst(0.01, mu=params_2004$estimate[1], sigma=params_2004$estimate[2], nu=params_2004$estimate[3])
var_2006 = qst(0.01, mu=params_2006$estimate[1], sigma=params_2006$estimate[2], nu=params_2006$estimate[3])
quantile(aex_2004$Returns, probs=0.01)
quantile(aex_2006$Returns, probs=0.01)
var_2004 = qst(0.01, mu=params_2004$estimate[1], sigma=params_2004$estimate[2], nu=params_2004$estimate[3])
var_2006 = qst(0.01, mu=params_2006$estimate[1], sigma=params_2006$estimate[2], nu=params_2006$estimate[3])
var_2004 = qst(0.01, mu=params_2004$estimate[1], sigma=params_2004$estimate[2], nu=params_2004$estimate[3])
var_2006 = qst(0.01, mu=params_2006$estimate[1], sigma=params_2006$estimate[2], nu=params_2006$estimate[3])
var_2004 = qst(0.01, mu=params_2004$estimate[1], sigma=params_2004$estimate[2], nu=params_2004$estimate[3])
var_2006 = qst(0.01, mu=params_2006$estimate[1], sigma=params_2006$estimate[2], nu=params_2006$estimate[3])
var_2004 = qst(0.01, mu=params_2004$estimate[1], sigma=params_2004$estimate[2], nu=params_2004$estimate[3])
var_2006 = qst(0.01, mu=params_2006$estimate[1], sigma=params_2006$estimate[2], nu=params_2006$estimate[3])
var_2004 = qst(0.01, mu=params_2004$estimate[1], sigma=params_2004$estimate[2], nu=params_2004$estimate[3])
var_2006 = qst(0.01, mu=params_2006$estimate[1], sigma=params_2006$estimate[2], nu=params_2006$estimate[3])
var_2004
var_2006
quantile(aex_2004$Returns, probs=0.01)
quantile(aex_2006$Returns, probs=0.01)
centered_2006 <- aex_2006$Returns - mean(aex_2006$Returns)
params_2006 = fitdistr(centered_2006, "t")
df_2006 =params_2006$estimate[3]
sd_2006 = params_2006$estimate[2]
x_2006 <- seq(min(centered_2006), max(centered_2006), length=length(centered_2006)-1)
fun_2006 <- dst(x_2006, mu=params_2006$estimate[1], sigma=sd_2006, nu=df_2006)
hist(centered_2006, prob=TRUE, breaks=15)
lines(x_2006, fun_2006, col=2,lwd=2)
centered_2006 <- aex_2006$Returns - mean(aex_2006$Returns)
params_2006 = fitdistr(centered_2006, "t")
df_2006 =params_2006$estimate[3]
sd_2006 = params_2006$estimate[2]
x_2006 <- seq(min(centered_2006), max(centered_2006), length=length(centered_2006)-1)
fun_2006 <- dst(x_2006, mu=params_2006$estimate[1], sigma=sd_2006, nu=df_2006)
hist(centered_2006, prob=TRUE, breaks=17)
lines(x_2006, fun_2006, col=2,lwd=2)
centered_2006 <- aex_2006$Returns - mean(aex_2006$Returns)
params_2006 = fitdistr(centered_2006, "t")
df_2006 =params_2006$estimate[3]
sd_2006 = params_2006$estimate[2]
x_2006 <- seq(min(centered_2006), max(centered_2006), length=length(centered_2006)-1)
fun_2006 <- dst(x_2006, mu=params_2006$estimate[1], sigma=sd_2006, nu=df_2006)
hist(centered_2006, prob=TRUE, breaks=18)
lines(x_2006, fun_2006, col=2,lwd=2)
centered_2006 <- aex_2006$Returns - mean(aex_2006$Returns)
params_2006 = fitdistr(centered_2006, "t")
df_2006 =params_2006$estimate[3]
sd_2006 = params_2006$estimate[2]
x_2006 <- seq(min(centered_2006), max(centered_2006), length=length(centered_2006)-1)
fun_2006 <- dst(x_2006, mu=params_2006$estimate[1], sigma=sd_2006, nu=df_2006)
hist(centered_2006, prob=TRUE, breaks=20)
lines(x_2006, fun_2006, col=2,lwd=2)
mean(aex_2004$Returns)
? var
?sd
mean(aex_2004$Returns)
qnorm(0.025)
qnorm(1-0.025)
mean(aex_2004$Returns)
qnorm(0.025)
qnorm(1-0.025)
qnorm(0.025)*var(aex_2004$Returns)
mean_2004 = mean(aex_2004$Returns)
var_2004 = var(aex_2004$Returns)
left_2004 = mean_2004 - qnorm(0.025)*var_2004
right_2004 = mean_2004 + qnorm(1-0.025)var_2004
mean_2004 = mean(aex_2004$Returns)
var_2004 = var(aex_2004$Returns)
left_2004 = mean_2004 - qnorm(0.025)*var_2004
right_2004 = mean_2004 + qnorm(1-0.025)*var_2004
mean_2004 = mean(aex_2004$Returns)
var_2004 = var(aex_2004$Returns)
sd_2004 = sd(aex_2004$Returns)
left_2004 = mean_2004 - qnorm(0.025)*var_2004/length(aex_2004)-1
right_2004 = mean_2004 + qnorm(1-0.025)*sd_2004
mean_2004 = mean(aex_2004$Returns)
var_2004 = var(aex_2004$Returns)
sd_2004 = sd(aex_2004$Returns)
left_2004 = mean_2004 - qnorm(0.025)*var_2004/length(aex_2004)
right_2004 = mean_2004 + qnorm(1-0.025)*sd_2004
mean_2004 = mean(aex_2004$Returns)
var_2004 = var(aex_2004$Returns)
sd_2004 = sd(aex_2004$Returns)
left_2004 = mean_2004 - qnorm(0.025)*var_2004/length(aex_2004)
right_2004 = mean_2004 + qnorm(1-0.025)*sd_2004
left_2004
right_2004
mean_2004 = mean(aex_2004$Returns)
var_2004 = var(aex_2004$Returns)
sd_2004 = sd(aex_2004$Returns)
left_2004 = mean_2004 - qnorm(0.025)*sd_2004/sqrt(length(aex_2004))
right_2004 = mean_2004 + qnorm(1-0.025)*sd_2004/sqrt(length(aex_2004))
left_2004
right_2004
hist(centered_2004, prob=TRUE, breaks=20)
mean_2004 = mean(aex_2004$Returns)
var_2004 = var(aex_2004$Returns)
sd_2004 = sd(aex_2004$Returns)
left_2004 = mean_2004 + qnorm(0.025)*sd_2004/sqrt(length(aex_2004))
right_2004 = mean_2004 + qnorm(1-0.025)*sd_2004/sqrt(length(aex_2004))
left_2004
right_2004
hist(aex_2004$Returns, prob=TRUE, breaks=20)
hist(aex_2004$Returns, prob=TRUE, breaks=20)
abline(v=left_2004)
abline(v=mean_2004)
abline(v=right_2004)
# hist(aex_2004$Returns, prob=TRUE, breaks=20)
abline(v=left_2004)
hist(aex_2004$Returns, prob=TRUE, breaks=20)
abline(v=left_2004)
abline(v=mean_2004)
abline(v=right_2004)
# hist(aex_2004$Returns, prob=TRUE, breaks=20)
plot.new()
abline(v=left_2004)
abline(v=mean_2004)
abline(v=right_2004)
hist(aex_2004$Returns, prob=TRUE, breaks=20)
abline(v=left_2004)
abline(v=mean_2004)
abline(v=right_2004)
hist(aex_2004$Returns, prob=TRUE, breaks=20)
abline(v=left_2004)
abline(v=mean_200,col='red', lwd=3, lty='dashed')
hist(aex_2004$Returns, prob=TRUE, breaks=20)
abline(v=left_2004)
abline(v=mean_2004,col='red', lwd=3, lty='dashed')
abline(v=right_2004)
hist(aex_2004$Returns, prob=TRUE, breaks=20)
abline(v=left_2004,col='red', lwd=3, lty='dashed')
abline(v=mean_2004,col='red', lwd=3)
abline(v=right_2004,col='red', lwd=3, lty='dashed')
hist(aex_2006$Returns, prob=TRUE, breaks=20)
abline(v=left_2006,col='red', lwd=3, lty='dashed')
mean_2006 = mean(aex_2006$Returns)
var_2006 = var(aex_2006$Returns)
sd_2006 = sd(aex_2006$Returns)
left_2006 = mean_2006 + qnorm(0.025)*sd_2006/sqrt(length(aex_2006))
right_2006 = mean_2006 + qnorm(1-0.025)*sd_2006/sqrt(length(aex_2006))
left_2006
right_2006
hist(aex_2006$Returns, prob=TRUE, breaks=20)
abline(v=left_2006,col='red', lwd=3, lty='dashed')
abline(v=mean_2006,col='red', lwd=3)
abline(v=right_2006,col='red', lwd=3, lty='dashed')
plot(cars)
# Load the data.
library("ggplot2")
aex = read.csv("AEX.csv")
aex$Date = as.Date(aex$Date)
library(hrbrthemes)
ggplot(aex) +
geom_line(mapping=aes(x=Date, y=Open, group=1), color = "blue", linetype = "solid", linewidth = .1) +
geom_line(mapping=aes(x=Date, y=Close, group=1), color = "red", linetype = "solid", linewidth = .1) +
scale_x_date(date_breaks = "1 year", date_labels =  "%Y") +
theme_ipsum() +
theme(axis.text=element_text(face="bold"),axis.title.x=element_text(face="bold"),axis.title.y=element_text(face="bold"),axis.text.x=element_text(angle=60, hjust=1))
aex_1993_1995 = aex[aex$Date>="1993-01-01" & aex$Date<= "1995-01-01",]
aex_1996_1998 = aex[aex$Date>= "1996-01-01" & aex$Date<="1998-01-01",]
print(paste("1993-1995 Opening Prices mean:", mean(aex_1993_1995$Close), ", sample deviation: " , sd(aex_1993_1995$Close), ", observations: ", length(aex_1993_1995$Close), sep=""))
print(paste("1996-1998 Opening Prices mean:", mean(aex_1996_1998$Close), ", sample deviation: " , sd(aex_1996_1998$Close), ", observations: ", length(aex_1993_1995$Close), sep=""))
aex$Returns = (aex$Close - aex$Open) / aex$Open
ggplot(aex) +
geom_point(mapping=aes(x=Date, y=Returns, group=1), color = "blue", size = 0.05)
print(summary(aex$Returns))
print(paste("SD: ", sd(aex$Returns)))
hist(aex$Returns, breaks=100)
aex$Year = format(aex$Date, "%Y")
boxplot(aex$Returns ~ aex$Year)
aex_2004 = aex[aex$Year == 2004, ]
aex_2006 = aex[aex$Year == 2006, ]
auto_corr <- function(ordered, k) {
sample_mean <- mean(ordered)
sample_var <- var(ordered)
count <- length(ordered)
first_demeaned <- ordered[1:(count-k)] - sample_mean
if (k > 0) {
shifted_demeaned <- ordered[-(1:k)] - sample_mean
} else {
shifted_demeaned <- ordered - sample_mean
}
return((1/((count-k)*sample_var)) * sum(first_demeaned*shifted_demeaned))
}
acf_2004 = c()
for (k in 0:(length(aex_2004$Returns)-1)) {
acf_2004 <- append(acf_2004, auto_corr(rev(aex_2004$Returns), k))
}
plot(acf_2004)
builtin_acf_2004 = acf(rev(aex_2004$Returns), lag.max=(length(aex_2004$Returns)-1), plot=FALSE)$acf[]
plot(builtin_acf_2004)
acf_2006 = c()
for (k in 0:(length(aex_2006$Returns)-1)) {
acf_2006 <- append(acf_2006, auto_corr(rev(aex_2006$Returns), k))
}
plot(acf_2006)
builtin_acf_2006 = acf(rev(aex_2006$Returns), lag.max=(length(aex_2006$Returns)-1), plot=FALSE)$acf[]
plot(builtin_acf_2006)
guess <- function(ordered, k) {
sample_mean <- mean(ordered)
sample_var <- var(ordered)
count <- length(ordered)
first_demeaned <- ordered[1:(count-k)] - sample_mean
if (k > 0) {
shifted_demeaned <- ordered[-(1:k)] - sample_mean
} else {
shifted_demeaned <- ordered - sample_mean
}
return((1/((count)*sample_var)) * sum(first_demeaned*shifted_demeaned))
}
gacf_2004 = c()
for (k in 0:(length(aex_2004$Returns)-1)) {
gacf_2004 <- append(gacf_2004, guess(rev(aex_2004$Returns), k))
}
gacf_2006 = c()
for (k in 0:(length(aex_2006$Returns)-1)) {
gacf_2006 <- append(gacf_2006, guess(rev(aex_2006$Returns), k))
}
plot(gacf_2004)
plot(gacf_2006)
library("car")
hist(aex_2004$Returns, breaks=20)
hist(aex_2006$Returns, breaks=20)
qqPlot(aex_2004$Returns)
qqPlot((aex_2006$Returns))
qqPlot(aex$Returns)
plot(density(aex_2004$Returns))
plot(density(aex_2006$Returns))
boxplot(aex_2004$Returns)
boxplot(aex_2006$Returns)
v_mm_est <- function(data) {
second_moment_expected <- mean(data^2)
v_mm <- -2*second_moment_expected/(1-second_moment_expected)
return(v_mm)
}
est <- v_mm_est(aex_2004$Returns - mean(aex_2004$Returns))
est
library(LaplacesDemon)
library(dplyr)
library(MASS)
centered_2004 <- aex_2004$Returns - mean(aex_2004$Returns)
params_2004 = fitdistr(centered_2004, "t")
df_2004=params_2004$estimate[3]
sd_2004 = params_2004$estimate[2]
x_2004 <- seq(min(centered_2004), max(centered_2004), length=length(centered_2004)-1)
# fun1 <- dst(x2, sigma=sd(centered)*0.9, nu=5)
# fun21 <- dst(x2, sigma=0.006730552, nu=9.636221)
fun2 <- dst(x_2004, mu=params_2004$estimate[1], sigma=sd_2004, nu=df_2004)
# fun3 <- dst(x2, sigma=sd(centered), nu=length(centered)-1)
hist(centered_2004, prob=TRUE, breaks=20)
# lines(x2, fun1, col=1,lwd=2)
lines(x_2004, fun2, col=2,lwd=2)
# lines(x2, fun3, col=3,lwd=2)
centered_2006 <- aex_2006$Returns - mean(aex_2006$Returns)
params_2006 = fitdistr(centered_2006, "t")
df_2006 =params_2006$estimate[3]
sd_2006 = params_2006$estimate[2]
x_2006 <- seq(min(centered_2006), max(centered_2006), length=length(centered_2006)-1)
fun_2006 <- dst(x_2006, mu=params_2006$estimate[1], sigma=sd_2006, nu=df_2006)
hist(centered_2006, prob=TRUE, breaks=20)
lines(x_2006, fun_2006, col=2,lwd=2)
VaR_2004 = qst(0.01, mu=params_2004$estimate[1], sigma=params_2004$estimate[2], nu=params_2004$estimate[3])
VaR_2006 = qst(0.01, mu=params_2006$estimate[1], sigma=params_2006$estimate[2], nu=params_2006$estimate[3])
VaR_2004
VaR_2006
quantile(aex_2004$Returns, probs=0.01)
quantile(aex_2006$Returns, probs=0.01)
mean_2004 = mean(aex_2004$Returns)
var_2004 = var(aex_2004$Returns)
sd_2004 = sd(aex_2004$Returns)
left_2004 = mean_2004 + qnorm(0.025)*sd_2004/sqrt(length(aex_2004))
right_2004 = mean_2004 + qnorm(1-0.025)*sd_2004/sqrt(length(aex_2004))
left_2004
right_2004
hist(aex_2004$Returns, prob=TRUE, breaks=20)
abline(v=left_2004,col='red', lwd=3, lty='dashed')
abline(v=mean_2004,col='red', lwd=3)
abline(v=right_2004,col='red', lwd=3, lty='dashed')
mean_2006 = mean(aex_2006$Returns)
var_2006 = var(aex_2006$Returns)
sd_2006 = sd(aex_2006$Returns)
left_2006 = mean_2006 + qnorm(0.025)*sd_2006/sqrt(length(aex_2006))
right_2006 = mean_2006 + qnorm(1-0.025)*sd_2006/sqrt(length(aex_2006))
left_2006
right_2006
hist(aex_2006$Returns, prob=TRUE, breaks=20)
abline(v=left_2006,col='red', lwd=3, lty='dashed')
abline(v=mean_2006,col='red', lwd=3)
abline(v=right_2006,col='red', lwd=3, lty='dashed')
